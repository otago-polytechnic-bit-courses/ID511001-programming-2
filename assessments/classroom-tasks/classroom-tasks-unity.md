# Classroom Tasks: Unity Game Engine

## Preparation

In the `Classroom Tasks` repository, create a new branch called **classroom-tasks-unity**.

Add the following rules to your repository `.gitignore` file:

```bash
# This .gitignore file should be placed at the root of your Unity project directory
#
# Get latest from https://github.com/github/gitignore/blob/main/Unity.gitignore
#
/[Ll]ibrary/
/[Tt]emp/
/[Oo]bj/
/[Bb]uild/
/[Bb]uilds/
/[Ll]ogs/
/[Uu]ser[Ss]ettings/

# MemoryCaptures can get excessive in size.
# They also could contain extremely sensitive data
/[Mm]emoryCaptures/

# Recordings can get excessive in size
/[Rr]ecordings/

# Uncomment this line if you wish to ignore the asset store tools plugin
# /[Aa]ssets/AssetStoreTools*

# Autogenerated Jetbrains Rider plugin
/[Aa]ssets/Plugins/Editor/JetBrains*

# Visual Studio cache directory
.vs/

# Gradle cache directory
.gradle/

# Autogenerated VS/MD/Consulo solution and project files
ExportedObj/
.consulo/
*.csproj
*.unityproj
*.sln
*.suo
*.tmp
*.user
*.userprefs
*.pidb
*.booproj
*.svd
*.pdb
*.mdb
*.opendb
*.VC.db

# Unity3D generated meta files
*.pidb.meta
*.pdb.meta
*.mdb.meta

# Unity3D generated file on crash reports
sysinfo.txt

# Builds
*.apk
*.aab
*.unitypackage
*.app

# Crashlytics generated file
crashlytics-build.properties

# Packed Addressables
/[Aa]ssets/[Aa]ddressable[Aa]ssets[Dd]ata/*/*.bin*

# Temporary auto-generated Android Assets
/[Aa]ssets/[Ss]treamingAssets/aa.meta
/[Aa]ssets/[Ss]treamingAssets/aa/*
```

**Note:** The `.gitignore` file should be placed at the root of your Unity project directory

**Resource:** <https://github.com/github/gitignore/blob/main/Unity.gitignore>

---

## Project Creation

Open **Unity Hub**. You will be presented with the following:

<img src="../resources/img/classroom-tasks/unity-1-project-creation.PNG" height="400" width="700" />

Currently, you have no projects. To create a new project, click on the **New project** button.

There are a variety of templates to choose from, i.e., 2D and 3D. Choose the **2D** template. In the **Project Settings**, you can set the project's name and location. Set the project's location to your **Class Tasks** repository path. Click on the **Create project** button.

<img src="../resources/img/classroom-tasks/unity-2-project-creation.PNG" height="400" width="700" />

---

## Project Configuration

In might take about a minute or so to create a new project. Once the project is created, you will be presented with the following:

<img src="../resources/img/classroom-tasks/unity-3-project-configuration.PNG" height="400" width="700" />

At first, it might be overwhelming. Do not worry, you will become somewhat familiar with the environment as you progress through the lecture notes. 

In the **Hierarchy** window displays every **GameObject** in a **Scene**. For example, **Main Camera**. You can use the **Hierarchy** window to add, remove, sort and group **GameObjects** in a **Scene**.

**Resource:** <https://docs.unity3d.com/Manual/Hierarchy>

<img src="../resources/img/classroom-tasks/unity-4-project-configuration.PNG" height="400" width="700" />

In the **Assets** window, create three new folders - `Prefabs`, `Scripts` and `Sprites`. To do so, right-click on the **Assets window > Create > Folder**. You will notice that each folder excluding `Scenes` are not solid grey. It indicates that these folders are empty.

<img src="../resources/img/classroom-tasks/unity-5-project-configuration.PNG" height="400" width="700" />

---

## Asset Creation

In this directory, you will find a directory called `assets`. This directory contains three assets - `background.png`, `obstacle.png` and `player.png`. Drag and drop these assets into the `Sprites` directory.

<img src="../resources/img/classroom-tasks/unity-6-asset-creation.PNG" height="400" width="700" />

---

## Player Controller

Drag and drop the `player` asset into the **Hierarchy** window. Rename the `player` asset (in the **Hierarchy** window) to `Player Sprite`. 

<img src="../resources/img/classroom-tasks/unity-7-player-controller.PNG" height="400" width="700" />

Create a new **GameObject** called `Player`. A **GameObject** is a base class for all entities, i.e., `Player Sprite` in a **Scene**. 

**Resource:** <https://docs.unity3d.com/ScriptReference/GameObject>

<img src="../resources/img/classroom-tasks/unity-8-player-controller.PNG" height="400" width="700" />

Drag and drop the `Player Sprite` into the `Player` **GameObject**. `Player Sprite` is a descendent or child of `Player` **GameObject**.

<img src="../resources/img/classroom-tasks/unity-9-player-controller.PNG" height="400" width="700" />

Click on the `Player` **GameObject**. In the **Inspector** window, click on the **Add component** button. Search for **Rigidbody 2D** and press <kbd>Enter</kbd>. **Rigidbody 2D** places an object under the control of the physics engine, i.e., allow the `Player` **GameObject** to move. Set the **Scale X and Y** to 0.5, **Gravity scale** to zero (0) to ensure the `Player` **GameObject** stays in the air and **Constraints > Freeze Rotation** to checked to prevent the `Player` **GameObject** from rotating/spinning on the Z axis.

**Note:** a **GameObject** can only have one **Rigidbody 2D** component.

**Resources:** 

- <https://docs.unity3d.com/Manual/UsingTheInspector>
- <https://docs.unity3d.com/Manual/class-Rigidbody2D>

<img src="../resources/img/classroom-tasks/unity-10-player-controller-2d-rigid-body.PNG" height="400" width="700" />

In the `Scripts` directory, create a new **C# Script**. To do so, right-click on the **Assets window/Scripts > Create > C# Script**. Name the **C# Script**, `PlayerController.cs`.

Open the `PlayerController.cs` **C# Script** in **Visual Studio Code**. Add the following code:

<img src="../resources/img/classroom-tasks/unity-11-player-controller-cs-script.PNG" height="400" width="700" />

Open the Please read the comments in the code snippet below:

```cs
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// PlayerController implements the MonoBehaviour interface.
// The MonoBehaviour interface's members which PlayerController must implement are Start() and Update()
public class PlayerController : MonoBehaviour
{
    // Public field which you can set its value in the Player GameObject's inspector window
    public float speed;

    private Rigidbody2D rb;
    private Vector2 direction;

    // Start is called before the first frame update
    void Start()
    {
        // Getting the component of type Rigidbody2D
        rb = GetComponent<Rigidbody2D>();
    }

    // Update is called once per frame
    void Update()
    {
        // Get the value of the virtual axis identified by "Horizontal" or "Vertical"
        // Resource: https://docs.unity3d.com/ScriptReference/Input.GetAxisRaw
        float directionY = Input.GetAxisRaw("Vertical");
        direction = new Vector2(0, directionY).normalized;
    }

    void FixedUpdate()
    {
        // The Rigidbody's velocity is specified as a vector with components in 
        // the X and Y directions. This allows the Player GameObject to move
        // in the Y direction direction at a given speed

        rb.velocity = new Vector2(0, direction.y * speed);
    }
}
```

Save the `PlayerController.cs` file and return to the **Unity Editor**.

In the **Hierarchy** window, click on the `Player` **GameObject**. Drag and drop the `PlayerController.cs` **C# Script** into the **Inspector** window. Set the `Speed` to 10.

<img src="../resources/img/classroom-tasks/unity-12-player-controller-adding-cs-script.PNG" height="400" width="700" />

Test the changes by clicking on the **Play** button. Move the `Player` **GameObject** by using the <kbd>↑</kbd> and <kbd>↓</kbd> arrows.

<img src="../resources/img/classroom-tasks/unity-13-player-controller-testing.PNG" height="400" width="700" />

---

## Camera Movement

In the `Scripts` directory, create a new **C# Script** called `CameraMovement.cs`. Open the `CameraMovement.cs` **C# Script** in **Visual Studio Code**. Add the following code:

```cs
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class CameraMovement : MonoBehaviour
{
    public float speed;

    // You can remove the Start() method

    // Update is called once per frame
    void Update()
    {
        // This will be used to move the camera on the X axis
        transform.position += new Vector3(speed * Time.deltaTime, 0, 0);
    }
}
```

<img src="../resources/img/classroom-tasks/unity-14-camera-movement.png" height="400" width="700" />

Create a new **GameObject** called `Game Manager`.

<img src="../resources/img/classroom-tasks/unity-15-camera-movement.png" height="400" width="700" />

In the **Hierarchy** window, click on the `Game Controller` **GameObject**. Drag and drop the `CameraMovement.cs` **C# Script** into the **Inspector** window. Set the `Speed` to 15.

<img src="../resources/img/classroom-tasks/unity-16-camera-movement.png" height="400" width="700" />

Drag and drop the `Main Camera` and `Player` **GameObjects** into the `Game Manager` **GameObject**. `Main Camera` and `Player` are descendent or children of `Game Manager` **GameObject**.

<img src="../resources/img/classroom-tasks/unity-17-camera-movement.png" height="400" width="700" />

---

## Background

In the **Hierarchy** window, create a new quad called `Background`. To do so, right-click on the **Hierarchy window > 3D Object > Quad**. 

<img src="../resources/img/classroom-tasks/unity-18-background.png" height="400" width="700" />

In the `Sprites` directory, click on the `background.png` file. Set the **Wrap Mode** to **Repeat**, then click on the **Apply** button.

<img src="../resources/img/classroom-tasks/unity-19-background.png" height="400" width="700" />

In the **Hierarchy** window, click on the `Background` **GameObject**. Drag and drop the `background` asset into the **Inspector** window. Set the **Shader** to **Unlit/Texture** and **Scale X** and **Y** to 20 and 10. As you can see, the background has cover the entire scene.

<img src="../resources/img/classroom-tasks/unity-20-background.png" height="400" width="700" />

Drag and drop the `Background` **GameObject** into the `Game Manager` **GameObject**.

<img src="../resources/img/classroom-tasks/unity-21-background.png" height="400" width="700" />

In the `Scripts` directory, create a new **C# Script** called `LoopingBackground.cs`. Open the `LoopingBackground.cs` **C# Script** in **Visual Studio Code**. Add the following code:

```cs
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class LoopingBackground : MonoBehaviour
{
    public float speed;
    public Renderer renderer;

    // You can remove the Start() method

    // Update is called once per frame
    void Update()
    {
        // This will be used to move the repeating background on the X axis. Note: ignore the warning
        renderer.material.mainTextureOffset += new Vector2(speed * Time.deltaTime, 0);
    }
}
```

<img src="../resources/img/classroom-tasks/unity-22-background.png" height="400" width="700" />

In the **Hierarchy** window, click on the `Background` **GameObject**. Drag and drop the `LoopingBackground.cs` **C# Script** into the **Inspector** window. Set the `Speed` to 1 and `Renderer` to **Background (Mesh Renderer)**.

<img src="../resources/img/classroom-tasks/unity-23-background.png" height="400" width="700" />

Test the changes by clicking on the **Play** button. 

---

## Obstacles

Drag and drop the `obstacle` asset into the `Game Manager` **GameObject**. Rename the `obstacle` asset to `Obstacle Sprite`.

<img src="../resources/img/classroom-tasks/unity-24-obstacle.png" height="400" width="700" />

Create a new **GameObject** called `Obstacle`. Drag and drop the `Obstacle Sprite` into the `Obstacle` **GameObject**. Set the **Scale X** and **Y** to 0.5. **Note:** make sure the `Obstacle` **GameObject** is in the `Game Manager` **GameObject**.

<img src="../resources/img/classroom-tasks/unity-25-obstacle.png" height="400" width="700" />

Drag and drop the `Obstacle` **GameObject** into the `Prefabs` directory.

**Resource:**

<img src="../resources/img/classroom-tasks/unity-26-obstacle.png" height="400" width="700" />

Delete the `Obstacle` **GameObject** from the `Game Manager` **GameObject**.

<img src="../resources/img/classroom-tasks/unity-27-obstacle.png" height="400" width="700" />

By now, you should have an understanding on how to use basic features in the **Unity Editor**.

Create a new **C# Script** called `SpawnObstacle.cs`. Add the following code:

```cs
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class SpawnObstacle : MonoBehaviour
{
    public GameObject obstacle;
    public float minX, minY, maxX, maxY;
    public float timeBetweenSpawn;
    private float spawnTime;

    // Update is called once per frame
    void Update()
    {
        if (Time.time > spawnTime)
        {
            Spawn();
            spawnTime = Time.time + timeBetweenSpawn;
        }
    }

    void Spawn()
    {
        float randX = Random.Range(minX, maxX);
        float randY = Random.Range(minY, maxY);
        Instantiate(obstacle, transform.position + new Vector3(randX, randY, 0), transform.rotation);
    }
}
```

Create a new **GameObject** called `Spawn Point` in the `Game Manager` **GameObject**. Add the `SpawnObstacle.cs` **C# Script** to the `Spawn Point` **GameObject**. Set `Obstacle` to the `obstacle` **Prefab**, `Max X` to 3.5, `Min X` to 3, `Max Y` to 4, `Min Y` to -4 and `Time Between Spawn` to 0.5. Set the `Spawn Point` **GameObject's** **Position X** to 20 so that it does not spawn an `Obstacle` **GameObject** on the `Player` **GameObject**. Test the changes by clicking on the **Play** button. 

<img src="../resources/img/classroom-tasks/unity-28-obstacle.png" height="400" width="700" />

## Other Functionality

### Player Collision

1. Create two **GameObjects** called `Edges` and `Top Edge`
2. Put the `Top Edge` **GameObject** in `Edges`
3. Put this in the `Game Manager` **GameObject**
4. Set the `Top Edge`'s **Y Position** to the top of the **Scene** 
5. In `Top Edge` **GameObject**, add a **Box Collider 2D** component. Click the **Add component** button
6. Set the **Box Collider 2D** component's **X Size** to 15
7. Copy the `Top Edge` **GameObject** and rename it `Bottom Edge`
8. Set the `Bottom Edge`'s **Y Position** to the bottom of the **Scene** 
9. In the `Player` **GameObject**, add a **Box Collider 2D** component
10. Edit the collider so that the box is around the `Player` **GameObject**
11. Run the game

**Resource:** <https://docs.unity3d.com/Manual/class-BoxCollider2D>

### Destroying Obstacles

1. Copy the `Top` or `Bottom Edge` **GameObject** and rename it `Left Edge`
2. Currently, the `Left Edge` **GameObject** is horizontal...what property allows you to rotate so that
the `Left Edge` **GameObject** is vertical?
3. Set the `Left Edge`'s **X Position** to the left of the **Scene**
4. In the `Edges` **GameObject**, create a tag called **"Edges"**. A tag is reference word that you assign to
one or more **GameObjects**
5. Apply the **"Edges"** tag to the `Top Edge`, `Bottom Edge` and `Left Edge` **GameObjects**
6. In the `Prefabs` directory, click on the `Obstacle` **Prefab** and click on the **Open Prefab** button
7. Add a **Circle Collider 2D** to the `Obstacle` **Prefab**
8. Check the **isTrigger** property
9. Edit the collider so that the circle is around the `Obstacle` **Prefab**
10. Create a new **C# Script** called `Collision.cs`
11. Create a method called `OnTriggerEnter2D` which accepts an argument called `Collider2D collision`

For example:

```cs
private void OnTriggerEnter2D(Collider2D collision)
```

12. In the code block, you want to check if the collision tag equals **"Edges"**. This is a simple `if` statement

For example: 

```cs
if (collision.tag == "Edges")
```

13. In side the `if` block, you want to destroy the **GameObject**, which in this case will be the `Obstacle` **Prefab**.
There is a function called `Destroy`. This function accepts a **GameObject**. To access the **GameObject**, use `this.gameObject`
14. Add the `Collision.cs` **C# Script** to the `Obstacle` **Prefab**
15. Add a **Rigidbody 2D** to the `Obstacle` **Prefab**. Set the **Gravity scale** to zero (0) and stop the `Obstacle` **Prefab** from rotating/spinning on the Z axis. 
16. Run the game

**Resources:** 

- <https://docs.unity3d.com/Manual/class-CircleCollider2D>
- <https://docs.unity3d.com/Manual/Tags>
- <https://docs.unity3d.com/ScriptReference/Object.Destroy>

### Collision Detection with Obstacles

Ideally, you want to display a game over screen when the `Player` **GameObject** collides with the `Obstacle` **Prefab**. 

1. Firstly, you will need to create a **panel**. To do this, in the **Hierarchy** window, right-click **UI > Panel**. This will create a **GameObject** called `Canvas`. 
2. Rename the `Panel` **GameObject** to `Game Over Panel`.
3. In the **Inspector** window, set the **Image > Color** value to **black**.
4. Click on the `Canvas` **GameObject** and set the **Canvas Scaler > UI Scale Mode** value to **Scale With Screen Size**. This enables the scene to scale with the screen size.
5. Set the **Canvas Scaler > Resolution's X** and **Y** values to 1600 and 900. Feel free to adjust these values.
6. Right-click the `Game Over Panel` **GameObject > UI > Image** and name the **Game Object** `Game Over Popup`.
7. Drag and drop the `game-over-popup.png` file in the `assets` directory into the `Sprites` directory.
8. Click on the `Game Over Popup` **GameObject** and set the **Image > Source Image** value to the `game-over-popup.png` file and **Rect Transform > Width** and **Rect Transform > Height** to appropriate values (You choose).  
9. Right-click the `Game Over Panel` **GameObject > UI > Text** and name the **Game Object** `Game Over Text`.
10. Click on the `Game Over Text` **GameObject** and set the **Text > Text** value to **Game Over!** and **Text > Character > Font Size** value to 100. I encourage you to try the other properties.
11. Right-click the `Game Over Panel` **GameObject > UI > Button** and name the **Game Object** `Restart Button`.
12. Change the **Width**, **Height** and **Text** values so that it is clear to the user.
13. Click on the `Player` **GameObject** and set the **tag** value to **"Player"**.
14. Hide the `Game Over Panel` **GameObject**.
15. Open the `Obstacle.cs` file. Declare `private GameObject player;`. In the `Start()` method, add the following code:

```cs
player = GameObject.FindGameObjectWithTag("Player");
```

In the `OnTriggerEnter2D()` method, add an if statement that checks if the collision's tag is **"Player"**. If `true`, destroy the `Player` **GameObject**.

15. Create a new **C# Script** called `GameOver.cs`. Declare `public GameObject gameOverPanel;`. In the `Update()` method, add an if statement that checks if the **GameObject** with the tag **"Player"** is `null`. If `true`, call the `Game Over Panel`'s `setActive()` and pass in the appropriate boolean, i.e., `true` or `false`.
16. Below the `using UnityEngine;` directive, add the following directive:

```cs
using UnityEngine.SceneManagement;
```
17. Create a new method called `Restart()` and add the following code:

```cs
SceneManager.LoadScene(SceneManager.GetActiveScene().name);
```
18. Add the `GameOver.cs` **C# Script** to the `Game Manager` **GameObject**.
19. Set the **Game Over Panel** value to the `Game Over Panel` **GameObject**.
20. Click on the `Restart Button` **GameObject** and in the **On Click()**, replace `None (Object)` with the `Game Manager` **GameObject** and set the **Runtime Only** value to **Game Over > Restart()**.

# Breakout

**Note:** You will need to create a new **2D** project.

Complete the following tutorial - <https://noobtuts.com/unity/2d-arkanoid-game>
